import { db, memDb } from './db';

var cleanupIntervalId;

async function cleanupActors() {
    let actors = await memDb.getActorsByType();

    for (let actor of actors) {
        // TODO: Implement unannounce API and increase this timeout
        if (Date.now() - actor.lastSeenTime > 12 * 1000) {
            await memDb.deleteActor(actor.id);
        }
    }
}

export function startCleanupInterval() {
    cleanupIntervalId = setInterval(cleanupActors, 5000);
}

export function stopCleanupInterval() {
    clearInterval(cleanupIntervalId);
}