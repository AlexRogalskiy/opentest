doctype html
html
    head
        block head
            title= title || 'OpenTest'
            meta(name="viewport", content="width=device-width, initial-scale=1.0")
            meta(http-equiv="X-UA-Compatible", content="IE=Edge")
            link(rel='stylesheet', href='/css/bootstrap.min.css')
            link(rel='stylesheet', href='/css/font-awesome.min.css')
            //link(rel='stylesheet', href='/css/bootstrap-theme.min.css')
            link(rel='stylesheet', href='/css/style.css')
            link(rel="icon" href="/favicon.ico?v=1")
            
            | <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
            | <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
            | <!--[if lt IE 9]>
            |   <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
            |   <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
            | <![endif]-->
            
            script(src="/js/lib/jquery.min.js")
            script(src="/js/lib/angular.min.js")
            script(src="/js/lib/bootstrap.min.js")
            script.
                /* thenBy.js - Copyright 2013 Teun Duynstee, licensed under the Apache License, Version 2.0 */
                !function(n,t){"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?module.exports=t():n.firstBy=t()}(this,function(){var n=function(){function n(n){return n}function t(n){return"string"==typeof n?n.toLowerCase():n}function e(e,r){if(r="number"==typeof r?{direction:r}:r||{},"function"!=typeof e){var i=e;e=function(n){return n[i]?n[i]:""}}if(1===e.length){var o=e,f=r.ignoreCase?t:n;e=function(n,t){return f(o(n))<f(o(t))?-1:f(o(n))>f(o(t))?1:0}}return r.direction===-1?function(n,t){return-e(n,t)}:e}function r(n,t){var i="function"==typeof this&&this,o=e(n,t),f=i?function(n,t){return i(n,t)||o(n,t)}:o;return f.thenBy=r,f}return r}();return n});
    body(ng-app="ngApp" ng-controller="LayoutCtrl" style="padding-top: 50px;")
        nav.navbar.navbar-default.navbar-fixed-top.header
            div.container
                div.navbar-header
                    button.navbar-toggle.collapsed(type="button" data-toggle="collapse" data-target="#main-menu" aria-expanded="false")
                        span.sr-only Toggle navigation
                        span.icon-bar
                        span.icon-bar
                        span.icon-bar
                    a.navbar-brand(href="/" style="font-weight: bold;") OpenTest

                div.collapse.navbar-collapse(id="main-menu")
                    ul.nav.navbar-nav
                        li
                            a(href="/") Home
                        li.dropdown
                            a.dropdown-toggle(href="#" data-toggle="dropdown")
                                | Session 
                                span.caret
                            ul.dropdown-menu
                                li
                                    a(href="#" data-toggle="modal" data-target="#create-session") Create Test Session...
                                li
                                    a(href="#" data-toggle="modal" data-target="#create-from-template") Create Session From Template...
                    - var commitSuffixMatch = (commitSha && commitSha.match(/-.*/)) || null;
                    - var commitSuffix = (commitSuffixMatch && commitSuffixMatch[0]) || '';
                    - var buildDateFormatted = moment(buildDate, 'YYYY-MM-DD HH:mm:ss ZZ').format('MMM D, H:mm');
                    - var shortCommit = commitSha.substring(0, 12) + commitSuffix;
                    span.pull-right.hidden-xs.text-muted(style="line-height:18px; margin-top: 8px")
                        | Build: #{version} #{buildDateFormatted}<br>
                        | Commit: #{shortCommit}
        p
        block content

        //- SELECT TEMPLATE MODAL DIALOG
        //- ============================
        div.modal.fade.in.create-session(id="create-from-template")
            div.modal-dialog.modal-lg
                div.modal-content
                    div.modal-header
                        button.close(data-dismiss="modal") &times;
                        p.modal-title Create Test Session from Template
                    div.modal-body
                        //- Progress indicator
                        div.progress-indicator(ng-show='vm.isLoadingTestInfo')
                            div.img
                        button.btn.btn-secondary(ng-click="vm.createSessionFromTemplate(vm.selectedTemplate)" ng-disabled="!vm.selectedTemplate") Create Session
                        div.hspace-double
                        button.btn.btn-secondary.btn-link(ng-click="vm.editTemplate()" ng-disabled="!vm.selectedTemplate") Edit Template
                        div.vspace-double
                        p Select a test session template from the list below. Click "Create Session" to create a new test session based of the selected template, or "Edit Template" to get a chance to look at the template and make some changes before creating the test session.
                        //- Progress indicator
                        div.progress-indicator(ng-show='vm.isLoadingTemplateInfo')
                            div.img
                        table.table.table-condensed.table-hover(ng-cloak ng-hide="!vm.templates.length" style="table-layout: fixed; word-wrap: break-word; margin-bottom: 0px")
                            tbody
                                tr(ng-repeat="template in vm.templates")
                                    td(style="width: 35px;")
                                        input(type="radio" name="template" id="{{'template'+$index}}" class="template" ng-model="vm.selectedTemplate" ng-value="template")
                                    td(style="width1: 300px")
                                        label(for="{{'template'+$index}}") {{template.name}}
                                    td(style="width1: 300px")
                                        label {{template.path}}
                                    td(style="width1: 100%")
                                        label {{template.description}}
                    //- div.modal-footer

        //- CREATE SESSION MODAL DIALOG
        //- ===========================
        div.modal.fade.create-session(id="create-session" style="overflow-y: scroll")
            div.modal-dialog.modal-lg
                div.modal-content
                    div.modal-header
                        a.dialog-close.pull-right(data-dismiss="modal") <i class="fa fa-times" aria-hidden="true"></i>
                        p.modal-title Create Test Session
                    div.modal-body
                        div
                            div.row
                                div.col-md-12
                                    button.btn.btn-secondary(data-dismiss="modal" ng-click="vm.createTestSession()") Create Session
                            div.vspace-double
                            div.row
                                div.col-md-6
                                    
                                    div.form-group
                                        input.form-control(type="text" ng-model="vm.sessionLabel" placeholder="Session label" title="Session label")
                                div.col-md-6
                                    select#session-iterations.form-control(ng-model="vm.iterations")
                                        option(value="1") 1 iteration
                                        option(value="2") 2 iterations
                                        option(value="3") 3 iterations
                            div.row
                                div.col-md-6
                                    select#evironment.form-control(ng-model="vm.selectedEnvironment" ng-disabled="!vm.environments" title="Environment")
                                        option(value="") No evironment selected
                                        option(ng-repeat="environment in vm.environments" value="{{environment}}") {{ environment }}
                                div.col-md-6
                                    input.form-control(type="text" ng-model="vm.actorTags" placeholder="Actor tags" title="Actor tags")
                            div.vspace-double
                            div.row(style="padding-top: 15px; padding-bottom: 10px")
                                div.col-md-6
                                    div
                                        input.form-control.search(type="text" ng-model="vm.searchText" placeholder="Search" title="Search")
                                        a(type="button" href="#" ng-click="vm.searchText = ''" ng-show="vm.searchText" style="position: absolute;top: 0px; right: 0px; opacity: 0.7; font-size: 1.5em; width: 15px") Ã—
                                div.col-md-3(style="font-size: 16px")
                                    //- input(id="only-selected" type="checkbox")
                                    //- label(for="only-selected") Show only selected
                                div.col-md-3
                                    span(style="font-size: 16px").pull-right {{ vm.selectedTestsCount }} tests selected
                            div.vspace-double
                            div.vspace-double
                            //- Progress indicator
                            div.progress-indicator(ng-show='vm.isLoadingTestInfo')
                                div.img
                            table.table.table-condensed.table-hover(ng-cloak ng-hide="!vm.tests.length" style="table-layout: fixed; word-wrap: break-word;")
                                //thead
                                    th(style="width: 40px;")
                                    th(style="width: 40%;") Test Name
                                    th(style="width: 45%;") Path
                                    th(style="width: auto;") Actors
                                tbody
                                    tr(ng-repeat="test in vm.filteredTests = (vm.tests | filter: { name: vm.searchText })")
                                        td(style="width: 40px;")
                                            input(type="checkbox" id="{{test.hash}}" class="test" ng-model="test.selected" ng-click="vm.testClick($event, test)")
                                        td(style="width: 40%;")
                                            label(for="{{test.hash}}") {{test.name}}
                                        td(style="width: 45%;")
                                            label {{test.path}}
                                        td(style="width: auto;")
                                            label {{test.actors.sort().join(', ')}}
                            p

        div#img-preloader
            img(src="/img/loader-circle.png" width="1" height="1")

        script(src="/js/lib/js.cookie.js")
        script(src="/js/lib/moment.min.js")
        script(src="/js/lib/moment-timezone.min.js")
        script(src="/js/ng/ng-app.js")
        script(src="/js/ng/layout-ctrl.js")
        
        script.
            // Highlight the UI tab that corresponds to the current location 
            $('a[href="' + this.location.pathname + '"]').parents('li,ul').addClass('active');

        block body_footer