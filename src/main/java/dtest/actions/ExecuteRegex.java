package dtest.actions;

import java.util.regex.Matcher;
import java.util.regex.Pattern;

import dtest.base.TestAction;

/**
 * An action that executes a regular expression on the specified text.
 */
public class ExecuteRegex extends TestAction {

	@Override
	public void run() {
		super.run();

		String text = readStringArgument("text");
		String regex = readStringArgument("regex");
		boolean matches;
		Pattern pattern = Pattern.compile(regex, Pattern.CASE_INSENSITIVE | Pattern.DOTALL);
		Matcher matcher = pattern.matcher(text);
		matches = matcher.matches();
		if (matcher.find()) {
			for (int groupNumber = 0; groupNumber <= matcher.groupCount(); groupNumber++) {
				this.writeOutput(String.format("group%d", groupNumber), matcher.group(groupNumber));
			}
		}
		this.writeOutput("isMatch", matches);
	}
}
