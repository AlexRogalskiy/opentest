package org.getopentest.selenium;

import org.openqa.selenium.By;
import org.openqa.selenium.support.ui.Select;

public class SelectListOption extends WebTestAction {

    @Override
    public void run() {
        super.run();

        By locator = this.readLocatorArgument("locator");
        String optionValue = this.readStringArgument("optionValue", null);
        String optionText = this.readStringArgument("optionText", null);
        Integer optionIndex = this.readIntArgument("optionIndex", null);

        this.waitForAsyncCallsToFinish();

        Select dropdownElement = new Select(this.getElement(locator));
        
        if (optionValue != null) {
            dropdownElement.selectByValue(optionValue);
        } else if (optionText != null) {
            dropdownElement.selectByVisibleText(optionText);
        } else if (optionIndex != null) {
            dropdownElement.selectByIndex(optionIndex);
        } else {
            throw new RuntimeException(
                    "You must identify the option you want to select from the list by providing at least "
                    + "one of the following arguments: optionValue, optionText or optionIndex.");
        }

    }

}
