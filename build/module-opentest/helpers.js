module.exports = {
    escapeRegEx: escapeRegEx,
    format: format,
    trimChars: trimChars
}

/** Escape a string so we can safely use it in a regular expression. */
function escapeRegEx(text) {
	return text.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g, "\\$&");
}

/** Utility function for string formatting.
 * Example: format("{0}, {1}!", "Hello", "world") // "Hello, world!" */
function format(text) {
    var args = arguments;
    var arg;
    var argIndex;

    return text.replace(
        /\{(\d+)\}/g,
        function (match, index) {
            argIndex = Number(index) + 1;
            arg = args[argIndex];
            switch (typeof arg) {
                case 'number':
                case 'string': return args[argIndex];
                case 'object': return JSON.stringify(args[argIndex]);
                case 'undefined': return match;
                default: return args[argIndex];
            }
        });
}

/** Trim specified characters from the beginning and end of a string. */
function trimChars(text, chars = ' \t\r\n\f') {
    if (!text) {
        return '';
    }

    const escapedChars = escapeRegEx(chars);
    const regex = new RegExp(
        format('^[{0}]+|[{0}]+$', escapedChars),
        'g');
    return text.replace(regex, '');
}