package org.getopentest.selenium;

import java.util.ArrayList;
import java.util.List;
import org.getopentest.selenium.core.SeleniumTestAction;
import org.openqa.selenium.UnsupportedCommandException;
import org.openqa.selenium.logging.LogEntry;

public class ReadBrowserLogs extends SeleniumTestAction {

    @Override
    public void run() {
        this.waitForAsyncCallsToFinish();

        try {
            List<LogEntry> logEntries = driver.manage().logs().get("browser").getAll();
            this.writeOutput("entries", this.getActor().toJsArray(logEntries));
        } catch (UnsupportedCommandException exc) {
            // Some browsers don't implement the logging API. If so, we'll just
            // return an empty array.
            this.writeOutput("entries", this.getActor().toJsArray(new ArrayList()));
        }
    }
}
