var rek = require('rekuire');
var db = rek('lib/db');

var intervalId;

function cleanupActors() {
    var actors = db.findActorsByTypeSync();
    var actor;

    for (var index = actors.length - 1; index >= 0; --index) {
        actor = actors[index];

        // TODO: Implement unannounce API and increase this timeout
        if (Date.now() - actor.lastSeenTime > 15 * 1000) {
            db.deleteActorSync(actor.id);
        }
    }
}

module.exports = {
    start: function() {
        intervalId = setInterval(cleanupActors, 5000);
    },
    stop: function() {
        clearInterval(intervalId);
    }
};